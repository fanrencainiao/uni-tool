{"version":3,"sources":["webpack:///C:/Users/Administrator/Documents/HBuilderProjects/tmUI-vuetify示例/tm-vuetify/components/tm-mapSelectedPoint/tm-mapSelectedPoint.vue?68b9","webpack:///C:/Users/Administrator/Documents/HBuilderProjects/tmUI-vuetify示例/tm-vuetify/components/tm-mapSelectedPoint/tm-mapSelectedPoint.vue?b78c","webpack:///C:/Users/Administrator/Documents/HBuilderProjects/tmUI-vuetify示例/tm-vuetify/components/tm-mapSelectedPoint/tm-mapSelectedPoint.vue?0e1b","webpack:///C:/Users/Administrator/Documents/HBuilderProjects/tmUI-vuetify示例/tm-vuetify/components/tm-mapSelectedPoint/tm-mapSelectedPoint.vue?81e2","uni-app:///tm-vuetify/components/tm-mapSelectedPoint/tm-mapSelectedPoint.vue"],"names":[],"mappings":"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","file":"tm-vuetify/components/tm-mapSelectedPoint/tm-mapSelectedPoint.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./tm-mapSelectedPoint.vue?vue&type=template&id=265222e9&\"\nvar renderjs\nimport script from \"./tm-mapSelectedPoint.vue?vue&type=script&lang=js&\"\nexport * from \"./tm-mapSelectedPoint.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"tm-vuetify/components/tm-mapSelectedPoint/tm-mapSelectedPoint.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./tm-mapSelectedPoint.vue?vue&type=template&id=265222e9&\"","var components\ntry {\n  components = {\n    tmButton: function() {\n      return import(\n        /* webpackChunkName: \"tm-vuetify/components/tm-button/tm-button\" */ \"@/tm-vuetify/components/tm-button/tm-button.vue\"\n      )\n    },\n    tmIcons: function() {\n      return import(\n        /* webpackChunkName: \"tm-vuetify/components/tm-icons/tm-icons\" */ \"@/tm-vuetify/components/tm-icons/tm-icons.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./tm-mapSelectedPoint.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./tm-mapSelectedPoint.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"tm-mapSelectedPoint\" :class=\"[black_tmeme?'grey-darken-5':'']\">\n\t\t<map :scale=\"mapscale\" id=\"MapTm\" ref=\"MapTm\" @regionchange=\"moveMapChange\" :markers=\"markers\" :latitude=\"mapCenter.lat\" :longitude=\"mapCenter.lng\" :style=\"{width:`${width}rpx`,height:`400rpx`}\"></map>\n\t\t<view class=\" pa-32 \">\r\n\t\t\t<view class=\"tm-mapSelectedPoint-contr\">\r\n\t\t\t\t<view class=\"pb-32\"><text class=\" text-size-n fulled text-overflow-1\">当前:{{adress.adress||\"获取失败，请移动地图选择\"}}</text></view>\r\n\t\t\t\t<view class=\"flex-between pb-10\">\r\n\t\t\t\t\t<tm-button @click=\"confirm\" block height=\"80\" style=\"width:60%\">确认位置</tm-button>\r\n\t\t\t\t\t<view style=\"width:35%\" class=\"flex-shrink\">\r\n\t\t\t\t\t\t<tm-button :black=\"black_tmeme\" :fllowTheme=\"fllowTheme\" :theme=\"color_tmeme\" @click=\"getLocation\" text block height=\"80\"  icon=\"icon-position-fill\">定位当前</tm-button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view v-if=\"adressList.length>0\" class=\"grey-lighten-5 px-24 round-6 mt-32\" :class=\"[black_tmeme?'bk grey-darken-4':'']\">\r\n\t\t\t\t<scroll-view scroll-y :style=\"{height: scrollHeight+'px'}\">\r\n\t\t\t\t\t<view @click=\"selecListitem(item)\" v-for=\"(item,index) in adressList\" :key=\"index\" :class=\"[black_tmeme?'bk':'']\" class=\"py-24 border-b-1 flex-between\">\r\n\t\t\t\t\t\t<view class=\"mr-32\">\r\n\t\t\t\t\t\t\t<view class=\"pb-12\">  {{item.name}}</view>\r\n\t\t\t\t\t\t\t<view class=\"text-size-s text-grey\">{{item.address}}</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"flex-shrink\">\r\n\t\t\t\t\t\t\t<tm-icons :black=\"black_tmeme\" :fllowTheme=\"fllowTheme\" :color=\"color_tmeme\" size=\"40\" v-if=\"activeId == item.id\" name=\"icon-check-circle\"></tm-icons>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\n</template>\n\n<script>\r\n\t/**\r\n\t * 地图选点\r\n\t * @property {Boolean|String} black = [true|false] 默认null,是否开启暗黑模式\r\n\t * @property {String} color = [] 主题默认:primary，提供是请写主题色名称\r\n\t * @property {String} map-key = [] 地图key:默认为作者测试的，用户不要使用我的，否则会被限制，key作废。\r\n\t * @property {String} map-type = [] 地图类型:qq，qq,baidu,amp高德。\r\n\t * @property {Number} scale = [] 默认:14，地图绽放级别5-18\r\n\t * @property {Number} width = [] 默认:700，组件的宽度。\r\n\t * @property {Number} height = [] 默认:1200，组件的高度。\r\n\t * @property {Object} location = [] 默认:{latitude:39.908823,longitude:116.39747}，默认的定位点，北京。\r\n\t * @property {Function} confirm 点击确认位置按钮时返回当前定位资料信息。\r\n\t * @property {Function} change 当移动地图时的位置信息，返回的结构同confirm\r\n\t */\r\n\timport tmButton from '@/tm-vuetify/components/tm-button/tm-button.vue';\n\timport tmIcons from '@/tm-vuetify/components/tm-icons/tm-icons.vue';\n\texport default {\r\n\t\tname:\"tm-mapSelectedPoint\",\r\n\t\tcomponents:{tmButton,tmIcons},\r\n\t\tprops:{\r\n\t\t\twidth:{\r\n\t\t\t\ttype:Number|String,\r\n\t\t\t\tdefault:700\r\n\t\t\t},\r\n\t\t\theight:{\r\n\t\t\t\ttype:Number|String,\r\n\t\t\t\tdefault:1200\r\n\t\t\t},\r\n\t\t\tlocation:{\r\n\t\t\t\ttype:Object,\r\n\t\t\t\tdefault:()=>{\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tlatitude:0,\r\n\t\t\t\t\t\tlongitude:0\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tscale:{\r\n\t\t\t\ttype:Number,\r\n\t\t\t\tdefault:14\r\n\t\t\t},\r\n\t\t\t// 是否开启暗黑模式\r\n\t\t\tblack: {\r\n\t\t\t\ttype: String | Boolean,\r\n\t\t\t\tdefault: null\r\n\t\t\t},\r\n\t\t\tcolor: {\r\n\t\t\t\ttype: String | Array,\r\n\t\t\t\tdefault: 'primary'\r\n\t\t\t},\r\n\t\t\t// 跟随主题色的改变而改变。\r\n\t\t\tfllowTheme: {\r\n\t\t\t\ttype: Boolean | String,\r\n\t\t\t\tdefault: true\r\n\t\t\t},\r\n\t\t\tmapKey:{\r\n\t\t\t\ttype:String,\r\n\t\t\t\tdefault:'U3QBZ-3YIKI-YBEGX-5WURG-5ZQE6-ZGFME'\r\n\t\t\t},\r\n\t\t\tmapType:{\r\n\t\t\t\ttype:String,\r\n\t\t\t\tdefault:'qq' //qq,baidu,amp\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tlocation:{\r\n\t\t\t\tdeep:true,\r\n\t\t\t\tasync handler(newValue, oldValue) {\r\n\t\t\t\t\tthis.moveMap(newValue.latitude,newValue.longitude)\r\n\t\t\t\t\tawait this.moveMarkes(newValue.latitude,newValue.longitude)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tnow_latitude:0,\n\t\t\t\tnow_longitude:0,\r\n\t\t\t\tmapCenter:{\r\n\t\t\t\t\tlat:0,\r\n\t\t\t\t\tlng:0\r\n\t\t\t\t},\r\n\t\t\t\tmarkers:[],\r\n\t\t\t\ttimeid:9566555566,\r\n\t\t\t\tadressList:[],\r\n\t\t\t\tadress:{\r\n\t\t\t\t\tadress:'',\r\n\t\t\t\t\tcity:[]\r\n\t\t\t\t},\r\n\t\t\t\tscrollHeight:0,\r\n\t\t\t\tactiveId:'',\r\n\t\t\t\tmap:null,\n\t\t\t};\n\t\t},\r\n\t\t\r\n\t\tcomputed:{\r\n\t\t\tblack_tmeme: function() {\r\n\t\t\t\tif (this.black !== null) return this.black;\r\n\t\t\t\treturn this.$tm.vx.state().tmVuetify.black;\r\n\t\t\t},\r\n\t\t\tcolor_tmeme: function() {\r\n\t\t\t\tif (this.$tm.vx.state().tmVuetify.color !== null && this.$tm.vx.state().tmVuetify.color && this\r\n\t\t\t\t\t.fllowTheme) {\r\n\t\t\t\t\treturn this.$tm.vx.state().tmVuetify.color;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.color;\r\n\t\t\t},\r\n\t\t\tmapscale:function(){\r\n\t\t\t\treturn this.scale;\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.now_latitude = this.location.latitude;\r\n\t\t\tthis.now_longitude = this.location.longitude;\r\n\t\t\tthis.mapCenter = {\r\n\t\t\t\tlat:this.location.latitude,\r\n\t\t\t\tlng:this.location.longitude\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync mounted() {\r\n\t\t\tlet t = this;\r\n\t\t\tthis.map = uni.createMapContext(\"MapTm\", this)\r\n\t\t\tlet q = await this.$Querey('.tm-mapSelectedPoint-contr',this).catch(e=>{});\r\n\t\t\tlet h = q[0].height||80;\r\n\t\t\tthis.scrollHeight = uni.upx2px(this.height) - uni.upx2px(400) - h;\r\n\t\t\t// #ifdef MP\r\n\t\t\tuni.authorize({\r\n\t\t\t    scope: 'scope.userLocation',\r\n\t\t\t    success() {\r\n\t\t\t        t.mapready();\r\n\t\t\t    }\r\n\t\t\t})\r\n\t\t\t// #endif\r\n\t\t\t// #ifndef MP\r\n\t\t\tthis.$nextTick(async function(){\r\n\t\t\t\tawait uni.$tm.sleep(200)\r\n\t\t\t\tawait this.mapready();\r\n\t\t\t})\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tmoveMap(latitude,longitude){\r\n\t\t\t\tthis.map.moveToLocation({\r\n\t\t\t\t\t  latitude:latitude,\r\n\t\t\t\t\t  longitude:longitude\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tasync mapready(){\r\n\t\t\t\t\r\n\t\t\t\tlet t = this;\r\n\t\t\t\t// #ifndef H5\r\n\t\t\t\tuni.getSetting({\r\n\t\t\t\t\tsuccess: async (res) => {\r\n\t\t\t\t\t\tif(!res.authSetting['scope.userLocation']){\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\ttitle:\"权限受限\",\r\n\t\t\t\t\t\t\t\tcontent:\"你禁止了位置受限，请打开设置，允许访问地址！否则功能无法使用。\",\r\n\t\t\t\t\t\t\t\tcancelText:\"我已允许\",\r\n\t\t\t\t\t\t\t\tconfirmText:\"前往设置\",\r\n\t\t\t\t\t\t\t\tsuccess: async (rks) => {\r\n\t\t\t\t\t\t\t\t\tif(rks.cancel==true){\r\n\t\t\t\t\t\t\t\t\t\t await t.getLocation();\r\n\t\t\t\t\t\t\t\t\t\t return\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tuni.openSetting({})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(t.mapCenter.lat !==0 && t.mapCenter.lng!==0){\r\n\t\t\t\t\t\t\tt.markers = [t.createMarker( t.mapCenter.lat ,t.mapCenter.lng)]\r\n\t\t\t\t\t\t\tawait t.poiSidel_byTencentMap(t.mapCenter.lat ,t.mapCenter.lng)\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tawait t.getLocation();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (res) => {\r\n\t\t\t\t\t\tuni.$tm.toast(\"系统错误\")\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// #endif\r\n\t\t\t\t\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\tif(t.mapCenter.lat !==0 && t.mapCenter.lng!==0){\r\n\t\t\t\t\tt.markers = [t.createMarker( t.mapCenter.lat ,t.mapCenter.lng)]\r\n\t\t\t\t\tawait t.poiSidel_byTencentMap(t.mapCenter.lat ,t.mapCenter.lng)\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tawait this.getLocation();\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tconfirm(){\r\n\t\t\t\tthis.$emit('confirm',{...this.adress,latitude:this.now_latitude,longitude:this.now_longitude})\r\n\t\t\t},\r\n\t\t\tasync getLocation() {\r\n\t\t\t\tlet t = this;\r\n\r\n\t\t\t\t//非h5通过GPS定位 。\r\n\t\t\r\n\t\t\t\t// #ifndef H5\r\n\t\t\t\tuni.getSetting({\r\n\t\t\t\t\tsuccess: async (res) => {\r\n\t\t\t\t\t\tif(!res.authSetting['scope.userLocation']){\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\ttitle:\"权限受限\",\r\n\t\t\t\t\t\t\t\tcontent:\"你禁止了位置受限，请打开设置，允许访问地址！否则功能无法使用。\",\r\n\t\t\t\t\t\t\t\tcancelText:\"我已允许\",\r\n\t\t\t\t\t\t\t\tconfirmText:\"前往设置\",\r\n\t\t\t\t\t\t\t\tsuccess: async (rks) => {\r\n\t\t\t\t\t\t\t\t\tif(rks.cancel==true){\r\n\t\t\t\t\t\t\t\t\t\t await t.getLocation();\r\n\t\t\t\t\t\t\t\t\t\t return\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tuni.openSetting({})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuni.getLocation({\r\n\t\t\t\t\t\t    type: 'gcj02', //返回可以用于uni.openLocation的经纬度\r\n\t\t\t\t\t\t    success:async function (res) {\r\n\t\t\t\t\t\t        const latitude = res.latitude;\r\n\t\t\t\t\t\t        const longitude = res.longitude;\r\n\t\t\t\t\t\t       t.now_latitude = latitude;\r\n\t\t\t\t\t\t       t.now_longitude = longitude;\r\n\t\t\t\t\t\t\t   t.mapCenter = {\r\n\t\t\t\t\t\t\t   \tlat:latitude,\r\n\t\t\t\t\t\t\t   \tlng:longitude\r\n\t\t\t\t\t\t\t   }\r\n\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t   t.moveMap(t.mapCenter.lat,t.mapCenter.lng)\r\n\t\t\t\t\t\t\t   await t.moveMarkes(latitude,longitude)\r\n\t\t\t\t\t\t\t   //缓存定位点。否则失败，间隔15s小于15秒。不允许调用。\r\n\t\t\t\t\t\t\t\tuni.setStorageSync('tmvue_map_selectePoint',{latitude:latitude,longitude:longitude})\r\n\t\t\t\t\t\t    },\r\n\t\t\t\t\t\t\tfail: async (err) => {\r\n\t\t\t\t\t\t\t\tlet p = uni.getStorageSync('tmvue_map_selectePoint');\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\ttry{\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tif(typeof p == 'object'){\r\n\t\t\t\t\t\t\t\t\t\tconst latitude = p .latitude;\r\n\t\t\t\t\t\t\t\t\t\tconst longitude = p .longitude;\r\n\t\t\t\t\t\t\t\t\t\tt.now_latitude = latitude;\r\n\t\t\t\t\t\t\t\t\t\tt.now_longitude = longitude;\r\n\t\t\t\t\t\t\t\t\t\tt.mapCenter = {\r\n\t\t\t\t\t\t\t\t\t\t\tlat:latitude,\r\n\t\t\t\t\t\t\t\t\t\t\tlng:longitude\r\n\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t\t\tt.moveMap(t.mapCenter.lat,t.mapCenter.lng)\r\n\t\t\t\t\t\t\t\t\t\tawait t.moveMarkes(latitude,longitude)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}catch(e){\r\n\t\t\t\t\t\t\t\t\tuni.$tm.toast('请间隙至少15s调用，不可频繁定位。')\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (res) => {\r\n\t\t\t\t\t\tuni.$tm.toast(\"系统错误\")\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// #endif\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t//h5通过ip定位 \r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\t\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask:true,title:'...'\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\t//没有获取到地址资料。通过Ip尝试定位 。\r\n\t\t\t\tlet adressPoiObj = await uni.$tm.request.get(\"https://apis.map.qq.com/ws/location/v1/ip?key=\"+this.mapKey).catch(e=>{\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tuni.$tm.toast(\"地址解析错误\")\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif(adressPoiObj['status']==0){\r\n\t\t\t\t\tt.now_latitude = adressPoiObj.result.location.lat;\r\n\t\t\t\t\tt.now_longitude = adressPoiObj.result.location.lng;\r\n\t\t\t\t\tt.map.moveToLocation({\r\n\t\t\t\t\t\t  latitude:t.now_latitude,\r\n\t\t\t\t\t\t  longitude:t.now_longitude\r\n\t\t\t\t\t})\r\n\t\t\t\t\tt.moveMap(t.mapCenter.lat,t.mapCenter.lng)\r\n\t\t\t\t\tt.markers = [t.createMarker( adressPoiObj.result.location.lat,adressPoiObj.result.location.lng)]\r\n\t\t\t\t\tawait t.poiSidel_byTencentMap(adressPoiObj.result.location.lat,adressPoiObj.result.location.lng)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tcreateMarker(latitude,longitude){\r\n\t\t\t\t\r\n\t\t\t\tlet id = 636598;\r\n\t\t\t\tlet label = {\r\n\t\t\t\t\tcontent:'',\r\n\t\t\t\t\tcolor:'#000000',\r\n\t\t\t\t\tfontSize:12,\r\n\t\t\t\t\tbgColor:'red',\r\n\t\t\t\t\tpadding:5,\r\n\t\t\t\t\ttextAlign:'center',\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid:id,\r\n\t\t\t\t\ticonPath:'/static/posiimg.png',\r\n\t\t\t\t\twidth:45,\r\n\t\t\t\t\theight:45,\r\n\t\t\t\t\tlatitude:latitude,\r\n\t\t\t\t\tlongitude:longitude,\r\n\t\t\t\t\tlabel:label,\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmoveMapChange(e){\r\n\t\t\t\tvar etype = ''\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\tetype = 'end'\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\tetype = e.type\r\n\t\t\t\t// #endif\r\n\t\t\t\tclearTimeout(this.timeid);\r\n\t\t\t\tif(etype ==='end'){\r\n\r\n\t\t\t\t\tlet t = this;\r\n\t\t\t\t\tthis.timeid = setTimeout(function() {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tt.map.getCenterLocation({\r\n\t\t\t\t\t\t\tsuccess:async (res)=>{\r\n\t\t\t\t\t\t\t\tawait t.moveMarkes(res.latitude,res.longitude)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}, 350);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tasync selecListitem(item){\r\n\t\t\t\tlet t = this;\r\n\t\t\t\tthis.$set(this.adress,'adress',item.address)\r\n\t\t\t\tawait this.moveMarkes(item.location.latitude,item.location.longitude)\r\n\t\t\t\tthis.activeId = item.id;\r\n\t\t\t},\r\n\t\t\tasync moveMarkes(latitude,longitude,callback){\r\n\t\t\t\tlet t = this;\r\n\t\t\t\tt.markers = []\r\n\t\t\t\tawait uni.$tm.sleep(50)\r\n\t\t\t\tif(t.markers.length==0){\r\n\t\t\t\t\tt.markers = [t.createMarker( latitude,longitude)]\r\n\t\t\t\t}\r\n\t\t\t\tt.now_latitude = latitude;\r\n\t\t\t\tt.now_longitude = longitude;\r\n\t\t\t\tt.poiSidel_byTencentMap(latitude,longitude)\r\n\t\t\t},\r\n\t\t\t//mp腾讯地址获取当前地址资料。\r\n\t\t\tasync poiSidel_byTencentMap(latitude,longitude){\r\n\t\t\t\tlet t = this;\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask:true,title:'...'\r\n\t\t\t\t})\r\n\t\t\t\tlet lot=`location=${latitude},${longitude}&get_poi=1&key=${this.mapKey}`\r\n\t\t\t\tlet adressPoiObj = await uni.$tm.request.get(\"https://apis.map.qq.com/ws/geocoder/v1/?\"+lot).catch(e=>{\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tuni.$tm.toast(\"地址解析错误\")\r\n\t\t\t\t})\r\n\t\t\t\tuni.hideLoading();\r\n\t\t\t\tif(adressPoiObj.status!==0){\r\n\t\t\t\t\tuni.$tm.toast(adressPoiObj.message)\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tlet adress = adressPoiObj.result;\r\n\t\t\t\tthis.$set(this.adress,'adress',adress.address)\r\n\t\t\t\tthis.$set(this.adress,'city',[adress.address_component.province,adress.address_component.city,adress.address_component.district]);\r\n\t\t\t\tthis.$emit('change',{...this.adress,latitude:this.now_latitude,longitude:this.now_longitude})\r\n\t\t\t\tlet pos  =  adress.pois;\r\n\t\t\t\tif(pos.length==0) return;\r\n\t\t\t\tlet list = [];\r\n\t\t\t\tfor(let i=0;i<pos.length;i++){\r\n\t\t\t\t\tlist.push({\r\n\t\t\t\t\t\taddress:pos[i].address,\r\n\t\t\t\t\t\tname:pos[i].title,\r\n\t\t\t\t\t\tid:pos[i].id,\r\n\t\t\t\t\t\tlocation:{\r\n\t\t\t\t\t\t\tlatitude:pos[i].location.lat,\r\n\t\t\t\t\t\t\tlongitude:pos[i].location.lng\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.adressList = list;\r\n\t\t\t}\r\n\t\t},\n\t}\n</script>\n\n<style lang=\"scss\">\n\n</style>\n"],"sourceRoot":""}