{"version":3,"sources":["webpack:///C:/Users/Administrator/Documents/HBuilderProjects/tmUI-vuetify示例/tm-vuetify/components/tm-render/tm-render.vue?b262","webpack:///C:/Users/Administrator/Documents/HBuilderProjects/tmUI-vuetify示例/tm-vuetify/components/tm-render/tm-render.vue?d0f0","webpack:///C:/Users/Administrator/Documents/HBuilderProjects/tmUI-vuetify示例/tm-vuetify/components/tm-render/tm-render.vue?4589","webpack:///C:/Users/Administrator/Documents/HBuilderProjects/tmUI-vuetify示例/tm-vuetify/components/tm-render/tm-render.vue?3b8f","uni-app:///tm-vuetify/components/tm-render/tm-render.vue","webpack:///C:/Users/Administrator/Documents/HBuilderProjects/tmUI-vuetify示例/tm-vuetify/components/tm-render/tm-render.vue?0cac","webpack:///C:/Users/Administrator/Documents/HBuilderProjects/tmUI-vuetify示例/tm-vuetify/components/tm-render/tm-render.vue?150c"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA0R;AAC1R;AAC6D;AACL;AACc;;;AAGtE;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,+EAAM;AACR,EAAE,wPAAM;AACR,EAAE,iQAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,4PAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAmmB,CAAgB,6nBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC0CvnB,8H;;;;AAIA,kB;AACA;AACA,mBADA;AAEA;AACA;AACA,kBADA;AAEA,gBAFA,EADA;;AAKA;AACA,kBADA;AAEA,kBAFA,EALA,EAFA;;;AAYA;AACA;AACA;AACA;AACA,OAHA;AAIA;AACA;AACA,OANA,EADA;;;AAUA;AACA;AACA,KAZA,EAZA;;AA0BA,SA1BA,qBA0BA;AACA;AACA;AACA;AACA,GA9BA;AA+BA,MA/BA,kBA+BA;AACA;AACA,oBADA;AAEA,uBAFA;AAGA,qBAHA,EAGA;AACA,cAJA;AAKA,cALA;AAMA,mBANA;AAOA,YAPA;;AASA;AACA,wBADA;AAEA,mBAFA;AAGA,eAHA;AAIA,yBAJA,EATA;;;AAgBA,GAhDA;AAiDA,SAjDA,qBAiDA;AACA;;AAEA,2BAFA;;;;;;;;;AAWA,GA7DA;;AA+DA,WA/DA,uBA+DA;AACA;AACA;AACA,GAlEA;AAmEA;AACA,SADA,mBACA;AACA,iBADA,GACA,KADA;AAEA,2EAFA,SAEA,GAFA;AAGA,iBAHA,GAGA,MAHA;AAIA;AACA;;AAEA;AACA,4BADA;AAEA,+BAFA;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAJA;;AAMA,iBA9BA,EA8BA,IA9BA,GAPA;;;;;;;;;;;;;;;;;;;;AAyDA,KA1DA;AA2DA,QA3DA,gBA2DA,IA3DA,EA2DA;AACA;AACA,KA7DA;AA8DA,sBA9DA,8BA8DA,KA9DA,EA8DA;;;;AAIA,uCAJA;;;;;;AAUA,iBAVA,CAMA,OANA,gBAMA,OANA,CAOA,QAPA,gBAOA,QAPA,CAQA,QARA,gBAQA,QARA,CASA,MATA,gBASA,MATA;;;;;;AAgBA,iBAhBA,CAaA,YAbA,gBAaA,YAbA,CAcA,QAdA,gBAcA,QAdA,CAeA,SAfA,gBAeA,SAfA;;;AAmBA,cAnBA,KAmBA,CAnBA,gBAmBA,CAnBA;;AAqBA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAxGA;AAyGA,aAzGA,uBAyGA;;;;AAIA;AACA,KA9GA;AA+GA,gBA/GA,wBA+GA,CA/GA,EA+GA;AACA;AACA;AACA;;AAEA,KApHA;AAqHA;AACA,cAtHA,sBAsHA,OAtHA,EAsHA,GAtHA,EAsHA;;;;;AAKA;;AAEA,KA7HA;AA8HA,YA9HA,oBA8HA,GA9HA,EA8HA;AACA,iBADA,GACA,MADA;AAEA,kBAFA,GAEA,GAFA;;;;;AAOA;AACA,mBADA,GACA;AACA;AACA,sBADA;AAEA,0CAFA;;AAIA,mBALA,CADA;AAOA;AACA,iBARA,MAQA;AACA;AACA,oBADA;AAEA,wCAFA;;AAIA;;AAEA,sBAtBA,GAsBA,sDAtBA;;AAwBA;AACA;AACA;AACA,iBAHA,EAxBA;;AA6BA,0CA7BA;;;;AAiCA,uDAjCA;AAkCA,KAhKA;AAiKA;AACA,0BAlKA,kCAkKA,KAlKA,EAkKA,MAlKA,EAkKA;AACA;;AAEA;AACA,oDADA;;AAGA,2DAHA;;AAKA,2CALA;;;AAQA,KA7KA;AA8KA,YA9KA,oBA8KA,KA9KA,EA8KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAJA,MAIA;AACA;AACA;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA,YADA;AAEA,YAFA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAPA;;AASA;AACA;;AAEA;AACA;AACA,cADA;AAEA,cAFA;;AAIA;AACA,KA5NA;AA6NA,aA7NA,qBA6NA,KA7NA,EA6NA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OALA,MAKA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YADA;AAEA,YAFA;;AAIA;AACA;AACA;AACA;AACA;AACA,OAFA;;AAIA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,+BADA,IACA,oBADA,IACA,2BADA,EACA;AACA;AACA,uBADA;AAEA,uBAFA;;AAIA,WANA,MAMA;AACA;AACA,sBADA;AAEA,sBAFA;;AAIA,WALA,MAKA;AACA;AACA,sCADA;;AAGA;;AAEA;AACA;AACA,oBADA;AAEA,oBAFA;;AAIA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA,KAlTA;AAmTA,cAnTA,sBAmTA,KAnTA,EAmTA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OALA,MAKA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAHA;;AAKA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,+BADA,IACA,oBADA,IACA,2BADA;;AAGA;AACA;AACA,WALA,MAKA;AACA;AACA,WAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAHA,MAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,cADA;AAEA,cAFA;;AAIA,OAnCA,MAmCA;AACA;AACA;;AAEA;AACA,YADA;AAEA,YAFA;;AAIA,KA1XA,EAnEA,E;;;;;;;;;;;;;AC/CA;AAAA;AAAA;AAAA;AAA8oC,CAAgB,onCAAG,EAAC,C;;;;;;;;;;;ACAlqC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"tm-vuetify/components/tm-render/tm-render.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./tm-render.vue?vue&type=template&id=5581a7e3&filter-modules=eyJDUmVuZGVyIjp7InR5cGUiOiJyZW5kZXJqcyIsImNvbnRlbnQiOiIiLCJzdGFydCI6MTI1NDcsImF0dHJzIjp7Im1vZHVsZSI6IkNSZW5kZXIiLCJsYW5nIjoianMifSwiZW5kIjoyMDEwOX19&\"\nvar renderjs\nimport script from \"./tm-render.vue?vue&type=script&lang=js&\"\nexport * from \"./tm-render.vue?vue&type=script&lang=js&\"\nimport style0 from \"./tm-render.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"tm-vuetify/components/tm-render/tm-render.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./tm-render.vue?vue&type=template&id=5581a7e3&filter-modules=eyJDUmVuZGVyIjp7InR5cGUiOiJyZW5kZXJqcyIsImNvbnRlbnQiOiIiLCJzdGFydCI6MTI1NDcsImF0dHJzIjp7Im1vZHVsZSI6IkNSZW5kZXIiLCJsYW5nIjoianMifSwiZW5kIjoyMDEwOX19&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./tm-render.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./tm-render.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"tm-render\" @touchmove.stop.prevent=\"\">\r\n\t\t\r\n\t\t\t<!-- #ifdef MP-WEIXIN || MP-QQ || MP-KUAISHOU || MP-ALIPAY  -->\r\n\t\t\t\r\n\t\t\t<canvas :style=\"{width:`${c_w}px`,height:`${c_h}px`}\" @mouseup=\"touchend\" @mousedown=\"touchstart\"\r\n\t\t\t\t@mousemove=\"touchmove\" @touchend=\"touchend\" @touchmove=\"touchmove\" @touchstart=\"touchstart\" id=\"exid\"\r\n\t\t\t\tcanvas-id=\"exid\" type=\"2d\"></canvas>\r\n\t\t\t\t\r\n\t\t\t<!-- #endif -->\r\n\t\t\t\r\n\t\t\t<!-- #ifndef MP-WEIXIN || MP-QQ || MP-KUAISHOU || MP-ALIPAY || APP-PLUS -->\r\n\t\t\t<canvas :style=\"{width:`${c_w}px`,height:`${c_h}px`}\" \r\n\t\t\t\t@mouseup=\"touchend\" \r\n\t\t\t\t@mousedown=\"touchstart\"\r\n\t\t\t\t@mousemove=\"touchmove\" \r\n\t\t\t\t@touchend=\"touchend\" \r\n\t\t\t\t@touchmove=\"touchmove\" \r\n\t\t\t\t@touchstart=\"touchstart\" \r\n\t\t\t\tid=\"exid\"\r\n\t\t\t\tcanvas-id=\"exid\" ></canvas>\r\n\t\t\t<!-- #endif -->\r\n\t\t\t\r\n\t\t\t<!-- #ifdef APP-PLUS-->\r\n\t\t\t\r\n\t\t\t<canvas \r\n\t\t\t@mouseup=\"CRender.touchend_app\"\r\n\t\t\t@mousedown=\"CRender.touchstart_app\"\r\n\t\t\t@mousemove=\"CRender.touchmove_app\"\r\n\t\t\t@touchend=\"CRender.touchend_app\" \r\n\t\t\t@touchmove=\"CRender.touchmove_app\" \r\n\t\t\t@touchstart=\"CRender.touchstart_app\" \r\n\t\t\t\r\n\t\t\t:prop=\"app_opts\" :change:prop=\"CRender.update_app_opts\" :style=\"{width:`${c_w}px`,height:`${c_h}px`}\" id=\"exid\" canvas-id=\"exid\" ></canvas>\r\n\t\t\t\t\r\n\t\t\t<!-- #endif -->\r\n\t\t\t\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\t// #ifndef APP-PLUS\r\n\timport CRender from '@/tm-vuetify/tool/function/crender/class/crender.class'\r\n\t// #endif\r\n\t\r\n\t\r\n\tlet render = null;\r\n\texport default {\r\n\t\tname: \"tm-render\",\r\n\t\tprops: {\r\n\t\t\twidth: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 0\r\n\t\t\t},\r\n\t\t\theight: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 600\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tc_w: {\r\n\t\t\t\tget: function() {\r\n\t\t\t\t\treturn this.cavan_width;\r\n\t\t\t\t},\r\n\t\t\t\tset: function(val) {\r\n\t\t\t\t\tthis.cavan_width = val;\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\t\t\tc_h: function() {\r\n\t\t\t\treturn uni.upx2px(this.height);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tconst dpr = uni.getSystemInfoSync().pixelRatio\r\n\t\t\tthis.dpr = dpr;\r\n\t\t\tthis.c_w = uni.upx2px(this.width);\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcavan_width: 0,\r\n\t\t\t\tcanvaConfig: null,\r\n\t\t\t\tdragGrpahId: '',//当前正在拖动或者点击的项目id.\r\n\t\t\t\told_x: 0,\r\n\t\t\t\told_y: 0,\r\n\t\t\t\tisDrag: false,\r\n\t\t\t\tdpr: 1,\r\n\t\t\t\t\r\n\t\t\t\tapp_opts:{\r\n\t\t\t\t\trender_app:null,\r\n\t\t\t\t\tgraph:null,\r\n\t\t\t\t\tfun:[],\r\n\t\t\t\t\tcanvaConfig:null\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.$nextTick(async function() {\r\n\t\t\t\t// #ifndef APP-PLUS\r\n\t\t\t\tthis.inits();\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\tlet res = await this.$Querey('.tm-render', this).catch(e => {})\r\n\t\t\t\tlet p = res[0];\r\n\t\t\t\tthis.$set(this.app_opts,'canvaConfig',p)\r\n\t\t\t\t\r\n\t\t\t\t// #endif\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\tdestroyed() {\r\n\t\t\trender = null;\r\n\t\t\tclearTimeout(555)\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tasync inits() {\r\n\t\t\t\tlet t = this;\r\n\t\t\t\tlet res = await this.$Querey('.tm-render', this).catch(e => {})\r\n\t\t\t\tlet p = res[0];\r\n\t\t\t\tt.c_w = p.width || 300;\r\n\t\t\t\tt.canvaConfig = p;\r\n\t\t\t\t//#ifdef MP-WEIXIN || MP-QQ || MP-KUAISHOU\r\n\t\t\t\tuni.createSelectorQuery().in(t).select('#exid').fields({\r\n\t\t\t\t\tnode: true,\r\n\t\t\t\t\tcontext: true,\r\n\t\t\t\t}, function(res) {\r\n\t\t\t\t\tlet canvas = res.node;\r\n\r\n\t\t\t\t\tlet ctx = canvas.getContext('2d')\r\n\t\t\t\t\tctx['dpr'] = t.dpr;\r\n\t\t\t\t\tctx['scaledpr'] = 10 / (10 * t.dpr);\r\n\t\t\t\t\tconst w = ctx['width'] = t.c_w\r\n\t\t\t\t\tconst h = ctx['height'] = t.c_h\r\n\r\n\t\t\t\t\t// canvas.width = res[0].width * dpr  \r\n\t\t\t\t\t// canvas.height = res[0].height * dpr  \r\n\t\t\t\t\tconst dpr = uni.getSystemInfoSync().pixelRatio\r\n\r\n\t\t\t\t\tcanvas.width = w * dpr\r\n\t\t\t\t\tcanvas.height = h * dpr\r\n\r\n\t\t\t\t\t// 设置 canvas 坐标原点\r\n\t\t\t\t\tctx.translate(0, 0);\r\n\t\t\t\t\tctx.scale(dpr, dpr)\r\n\t\t\t\t\trender = new CRender(ctx, t, canvas)\r\n\r\n\t\t\t\t\tt.$nextTick(function() {\r\n\t\t\t\t\t\t// t.$emit('render', render.area);\r\n\t\t\t\t\t\t// 12296升级改造\r\n\t\t\t\t\t\tt.$emit('render', render.area);\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t}).exec()\r\n\r\n\t\t\t\t//#endif\r\n\t\t\t\t//#ifndef MP-WEIXIN || MP-QQ || MP-KUAISHOU || MP-ALIPAY || APP-PLUS\r\n\t\t\t\tlet ctx = uni.createCanvasContext('exid', t)\r\n\t\t\t\t\r\n\t\t\t\tctx['dpr'] = t.dpr;\r\n\t\t\t\tctx['scaledpr'] = 10 / (10 * t.dpr);\r\n\t\t\t\tconst w = ctx['width'] = t.c_w\r\n\t\t\t\tconst h = ctx['height'] = t.c_h\r\n\r\n\t\t\t\trender = new CRender(ctx, t)\r\n\r\n\t\t\t\tt.$nextTick(function() {\r\n\t\t\t\t\t// 12296升级改造\r\n\t\t\t\t\tt.$emit('render', render.area);\r\n\t\t\t\t\t// t.$emit('render', render.area);\r\n\t\t\t\t})\r\n\r\n\t\t\t\t//#endif\r\n\t\t\t},\r\n\t\t\twait(time) {\r\n\t\t\t\treturn new Promise(resolve => setTimeout(resolve, time))\r\n\t\t\t},\r\n\t\t\tgetTextWidthAndPos(shape) {\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\treturn [0,0,0,0];\r\n\t\t\t\t// #endif\r\n\t\t\t\tif (!render) return [0, 0, 0, 0];\r\n\t\t\t\tlet {\r\n\t\t\t\t\tcontent,\r\n\t\t\t\t\tposition,\r\n\t\t\t\t\tmaxWidth,\r\n\t\t\t\t\trowGap\r\n\t\t\t\t} = shape.shape\r\n\r\n\t\t\t\tconst {\r\n\t\t\t\t\ttextBaseline,\r\n\t\t\t\t\tfontSize,\r\n\t\t\t\t\ttextAlign\r\n\t\t\t\t} = shape.style\r\n\r\n\r\n\t\t\t\tlet [x, y] = position\r\n\r\n\t\t\t\tcontent = content.split('\\n')\r\n\t\t\t\tconst rowNum = content.length\r\n\t\t\t\tconst lineHeight = fontSize + rowGap\r\n\t\t\t\tconst allHeight = rowNum * lineHeight - rowGap\r\n\t\t\t\tconst twidth = render.ctx.measureText(content + \"\").width;\r\n\t\t\t\tif (textBaseline === 'middle') {\r\n\r\n\t\t\t\t\ty -= allHeight * rowNum + fontSize / 2\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (textBaseline === 'bottom') {\r\n\r\n\t\t\t\t\ty += fontSize\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (textAlign === 'center') {\r\n\t\t\t\t\tx -= twidth / 2\r\n\t\t\t\t\ty += fontSize\r\n\t\t\t\t}\r\n\t\t\t\treturn [x, y, twidth, allHeight]\r\n\t\t\t\t// measureText\r\n\t\t\t},\r\n\t\t\tgetRender() {\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\treturn this.app_opts.render_app;\r\n\t\t\t\t// #endif\r\n\t\t\t\treturn render;\r\n\t\t\t},\r\n\t\t\trenderCavans(e){\r\n\t\t\t\trender = e;\r\n\t\t\t\t//app触发这里。\r\n\t\t\t\tthis.$emit('render', render.area);\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\t//app-plus代理执行函数，参数一为函数名称，参数二为参数。\r\n\t\t\tappCallFun(funName,arg){\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\tthis.$set( this.app_opts,'fun',[funName,arg])\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifndef APP-PLUS\r\n\t\t\t\tconsole.error(\"此函数为APP-PLUS专用，详见：https://jx2d.cn/guid/render/%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8.html\")\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tasync addGraph(obj) {\r\n\t\t\t\tlet t = this;\r\n\t\t\t\tlet pf = obj;\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\tthis.$set( this.app_opts,'graph',obj)\r\n\t\t\t\treturn \r\n\t\t\t\t// #endif\r\n\t\t\t\tif (typeof obj == 'object' && Array.isArray(obj)) {\r\n\t\t\t\t\tlet c = obj.filter(el => {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t...el,\r\n\t\t\t\t\t\t\ttmid: uni.$tm.guid()\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t})\r\n\t\t\t\t\tpf = c;\r\n\t\t\t\t} else if (typeof obj == 'object' && !Array.isArray(obj)) {\r\n\t\t\t\t\tpf = [{\r\n\t\t\t\t\t\t...pf,\r\n\t\t\t\t\t\ttmid: uni.$tm.guid()\r\n\t\t\t\t\t}]\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet graphs = pf.map(config => render.add(config))\r\n\r\n\t\t\t\tgraphs.forEach((graph, i) => {\r\n\t\t\t\t\tconst config = pf[i]\r\n\t\t\t\t\tt.updateGraphConfigByKey(graph, config)\r\n\t\t\t\t})\r\n\r\n\t\t\t\tawait render.launchAnimation()\r\n\t\t\t\t//释放内存。\r\n\t\t\t\t// graphs = []\r\n\t\t\t\t\r\n\t\t\t\treturn graphs.length == 1 ? graphs[0] : graphs;\r\n\t\t\t},\r\n\t\t\t//添加完毕需要更新下，才会显示。\r\n\t\t\tupdateGraphConfigByKey(graph, config) {\r\n\t\t\t\tconst keys = Object.keys(config)\r\n\r\n\t\t\t\tkeys.forEach(async key => {\r\n\t\t\t\t\tif (key === 'shape' || key === 'style') {\r\n\t\t\t\t\t\t// graph.animation('shape', {x:config.shape.x+5}, true)\r\n\t\t\t\t\t\tawait graph.animation(key, config[key], true)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tgraph[key] = config[key]\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\ttouchend(event) {\r\n\t\t\t\tlet t = this;\r\n\t\t\t\tlet evx = 0;\r\n\t\t\t\tlet evy = 0;\r\n\t\t\t\t//触摸\r\n\t\t\t\tif (event.type.indexOf('mouse') == -1 && event.changedTouches.length == 1) {\r\n\t\t\t\t\tevx = event.changedTouches[0].x\r\n\t\t\t\t\tevy = event.changedTouches[0].y\r\n\t\t\t\t\t//电脑端。\r\n\t\t\t\t} else {\r\n\t\t\t\t\tevx = event.pageX - this.canvaConfig.left\r\n\t\t\t\t\tevy = event.pageY - this.canvaConfig.top;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet x = evx;\r\n\t\t\t\tlet y = evy;\r\n\r\n\r\n\t\t\t\tthis.dragGrpahId = \"\";\r\n\t\t\t\tthis.isDrag = false\r\n\t\t\t\t//触发画板的事件。\r\n\t\t\t\tthis.$emit('touchend', {\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y\r\n\t\t\t\t})\r\n\t\t\t\t//在那个元素上离开的。\r\n\t\t\t\tlet gps = render.graphs;\r\n\t\t\t\tlet isClickGrpahs = gps.filter((el, index) => {\r\n\t\t\t\t\tif (el.name == 'text') {\r\n\t\t\t\t\t\tlet rect = t.getTextWidthAndPos(el);\r\n\t\t\t\t\t\tel.hoverRect = rect\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn el.hoverCheck([x, y], el) || el.hoverCheckProcessor([x, y], el);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (isClickGrpahs.length > 0) {\r\n\t\t\t\t\tlet nowgap = isClickGrpahs[0];\r\n\r\n\t\t\t\t\t// 执行元素上绑定的事件。\r\n\t\t\t\t\tif (nowgap[event.type]) nowgap[event.type].call(nowgap, {\r\n\t\t\t\t\t\tx: x,\r\n\t\t\t\t\t\ty: y\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttouchmove(event) {\r\n\t\t\t\t\r\n\t\t\t\tlet t = this;\r\n\t\t\t\tlet evx = 0;\r\n\t\t\t\tlet evy = 0;\r\n\t\t\t\tlet isPc = false\r\n\t\t\t\t//触摸\r\n\t\t\t\tif (event.type.indexOf('mouse') == -1 && event.changedTouches.length == 1) {\r\n\t\t\t\t\tevx = event.changedTouches[0].x\r\n\t\t\t\t\tevy = event.changedTouches[0].y\r\n\t\t\t\t\tisPc = false\r\n\t\t\t\t\t//电脑端。\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tevx = event.pageX - this.canvaConfig.left\r\n\t\t\t\t\tevy = event.pageY - this.canvaConfig.top;\r\n\t\t\t\t\tisPc = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet movex = evx - this.old_x;\r\n\t\t\t\tlet movey = evy - this.old_y;\r\n\t\t\t\tlet x = evx;\r\n\t\t\t\tlet y = evy;\r\n\t\t\t\t// 触发发画板的事件\r\n\t\t\t\tthis.$emit('touchmove', {\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y\r\n\t\t\t\t})\r\n\t\t\t\tif(this.isDrag==false) return;\r\n\t\t\t\t//在哪个元素移动的。\r\n\t\t\t\tlet gps = render.graphs;\r\n\t\t\t\tlet isClickGrpahs = gps.filter((el, index) => {\r\n\t\t\t\t\treturn (el.hoverCheck([x, y], el) || el.hoverCheckProcessor([x, y], el))&&el.tmid==t.dragGrpahId;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (isClickGrpahs.length > 0) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet nowgap = isClickGrpahs[0];\r\n\t\t\t\t\tif (isPc) {\r\n\t\t\t\t\t\tmovex = evx - this.old_x;\r\n\t\t\t\t\t\tmovey = evy - this.old_y;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ((nowgap.drag === true && this.isDrag == true) || (nowgap.drag === true && isPc == false)) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (nowgap.name == \"circle\" || nowgap.name == \"ellipse\" ||\r\n\t\t\t\t\t\t\tnowgap.name == \"ring\" || nowgap.name == \"arc\" || nowgap.name == \"regPolygon\") {\r\n\t\t\t\t\t\t\tnowgap.attr('shape', {\r\n\t\t\t\t\t\t\t\trx: movex,\r\n\t\t\t\t\t\t\t\try: movey\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else if (nowgap.name == \"rect\" ||nowgap.name ==  'rectRound'|| nowgap.name == \"path\"|| nowgap.name == \"image\"|| nowgap.name == \"star\" || nowgap.name =='arrow') {\r\n\t\t\t\t\t\t\tnowgap.attr('shape', {\r\n\t\t\t\t\t\t\t\tx: movex,\r\n\t\t\t\t\t\t\t\ty: movey\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else if (nowgap.name == \"text\") {\r\n\t\t\t\t\t\t\tnowgap.attr('shape', {\r\n\t\t\t\t\t\t\t\tposition: [movex, movey]\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 执行元素上绑定的事件。\r\n\t\t\t\t\t\tif (nowgap[event.type]) nowgap[event.type].call(nowgap, {\r\n\t\t\t\t\t\t\tx: movex,\r\n\t\t\t\t\t\t\ty: movey\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// if(nowgap['mousemove']||nowgap['touchmove']){\r\n\r\n\t\t\t\t\t\t// \tif (nowgap['mousemove']) nowgap.mousemove.call(nowgap,{x:movex,y:movey})\r\n\t\t\t\t\t\t// \tif (nowgap['touchmove']) nowgap.touchmove.call(nowgap,{x:movex,y:movey})\r\n\t\t\t\t\t\t// }\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//配置不允许拖出边界。\r\n\t\t\t\t\t// if(this.dragGrpahId === nowgap.tmid \r\n\t\t\t\t\t// && movex+nowgap.shape.w<this.canvaConfig.width\r\n\t\t\t\t\t// && movey+nowgap.shape.h<this.canvaConfig.height\r\n\t\t\t\t\t// && x>=0&&y>=0&&movex>=0&&movey>=0\r\n\t\t\t\t\t// ){\r\n\r\n\r\n\t\t\t\t\t// }\r\n\t\t\t\t\t// this.$emit('shape:touchmove',{x:x,y:y,shape:nowgap})\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\ttouchstart(event) {\r\n\t\t\t\t\r\n\t\t\t\tlet t = this;\r\n\t\t\t\tlet evx = 0;\r\n\t\t\t\tlet evy = 0;\r\n\t\t\t\tlet isPc = false\r\n\t\t\t\t//触摸\r\n\t\t\t\tif (event.type.indexOf('mouse') == -1 && event.changedTouches.length == 1) {\r\n\t\t\t\t\tevx = event.changedTouches[0].x\r\n\t\t\t\t\tevy = event.changedTouches[0].y\r\n\t\t\t\t\tisPc = false\r\n\t\t\t\t\t//电脑端。\r\n\t\t\t\t} else {\r\n\t\t\t\t\tevx = event.pageX - this.canvaConfig.left\r\n\t\t\t\t\tevy = event.pageY - this.canvaConfig.top\r\n\t\t\t\t\tisPc = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet x = evx\r\n\t\t\t\tlet y = evy\r\n\r\n\t\t\t\tlet gps = render.graphs;\r\n\t\t\t\t//点中了哪些图片，第一个是最顶层的，依次类推。\r\n\t\t\t\tlet isClickGrpahs = gps.filter((el, index) => {\r\n\t\t\t\t\t// 要判断谁的层级高就是先托动谁。\r\n\t\t\t\t\treturn el.hoverCheck([x, y], el) || el.hoverCheckProcessor([x, y], el);\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tif (isClickGrpahs.length > 0) {\r\n\t\t\t\t\tvar indexOfMax = 0;\r\n\t\t\t\t\tvar max = isClickGrpahs.reduce( (a,c,i) => c.index > a ? (indexOfMax = i,c.index) : a, 0)\r\n\t\t\t\t\tlet nowgap = isClickGrpahs[indexOfMax];\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (nowgap.drag === true) {\r\n\t\t\t\t\t\tthis.dragGrpahId = nowgap.tmid;\r\n\t\t\t\t\t\tlet gapPos = [];\r\n\t\t\t\t\t\tif (nowgap.name == \"circle\" || nowgap.name == \"ellipse\" ||\r\n\t\t\t\t\t\t\tnowgap.name == \"ring\" || nowgap.name == \"arc\" || nowgap.name == \"regPolygon\"\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tgapPos = [nowgap.shape.rx, nowgap.shape.ry]\r\n\t\t\t\t\t\t} else if (nowgap.name == \"rect\" ||nowgap.name ==  'rectRound'|| nowgap.name == \"path\"|| nowgap.name == \"image\"|| nowgap.name == \"star\"|| nowgap.name =='arrow') {\r\n\t\t\t\t\t\t\tgapPos = [nowgap.shape.x, nowgap.shape.y]\r\n\t\t\t\t\t\t} else if (nowgap.name == \"text\") {\r\n\t\t\t\t\t\t\tgapPos = nowgap.shape.position\r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t\tif (isPc) {\r\n\t\t\t\t\t\t\tthis.old_x = evx - gapPos[0]\r\n\t\t\t\t\t\t\tthis.old_y = evy - gapPos[1];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.old_x = x - gapPos[0];\r\n\t\t\t\t\t\t\tthis.old_y = y - gapPos[1];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.isDrag = true\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 执行元素上绑定的事件。\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (nowgap[event.type]) nowgap[event.type].call(nowgap, {\r\n\t\t\t\t\t\tx: x,\r\n\t\t\t\t\t\ty: y\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.dragGrpahId = \"\"\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.$emit('touchstart', {\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t},\r\n\r\n\t}\r\n</script>\r\n<script module=\"CRender\" lang=\"renderjs\">\r\n\t\r\n\tvar cdr = require('@/tm-vuetify/tool/function/crender/crender.min.js')\r\n\tconst CRender = window.CRender.CRender\r\n\tvar  render_app;\r\n\texport default {\r\n\t\tmounted() {\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\tthis.$nextTick(function(){\r\n\t\t\t\tthis.initsAppH5();\r\n\t\t\t})\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tinitsAppH5(e) {\r\n\t\t\t\tlet t = this;\r\n\t\t\t\tlet canvas = document.querySelector('#exid').querySelector('canvas')\r\n\t\t\t\tlet canvasPrent = document.querySelector('.tm-render')\r\n\t\t\t\tlet w = canvasPrent.offsetWidth;\r\n\t\t\t\tlet h = canvasPrent.offsetHeight;\r\n\t\t\t\tcanvas.style.width = w+'px';\r\n\t\t\t\tcanvas.style.height = h+'px';\r\n\t\t\t\trender_app = new CRender(canvas)\r\n\t\t\t\t\r\n\t\t\t\tthis.$ownerInstance.$vm.$set(this.$ownerInstance.$vm.app_opts,'render_app',render_app)\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tt.$ownerInstance.callMethod('renderCavans', render_app)\r\n\t\t\t\t}, 10);\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tupdate_app_opts(newValue, oldValue, ownerInstance, instance) {\r\n\t\t\t\tif(newValue.graph){\r\n\t\t\t\t\tlet graph = render_app.add(newValue.graph)\r\n\t\t\t\t\tthis.$ownerInstance.$vm.app_opts.graph=null;\r\n\t\t\t\t}\r\n\t\t\t\tif(newValue.fun){\r\n\t\t\t\t\tif(typeof(newValue.fun)==\"object\" && Array.isArray(newValue.fun)){\r\n\t\t\t\t\t\tif(newValue.fun.length>0){\r\n\t\t\t\t\t\t\tif(newValue.fun.length==1){\r\n\t\t\t\t\t\t\t\trender_app[newValue.fun[0]]();\r\n\t\t\t\t\t\t\t}else if(newValue.fun.length==2){\r\n\t\t\t\t\t\t\t\trender_app[newValue.fun[0]](newValue.fun[1])\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\twait(time) {\r\n\t\t\t\treturn new Promise(resolve => setTimeout(resolve, time))\r\n\t\t\t},\r\n\t\t\tgetTextWidthAndPos(shape) {\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\treturn [0,0,0,0];\r\n\t\t\t\t// #endif\r\n\t\t\t\tif (!render) return [0, 0, 0, 0];\r\n\t\t\t\tlet {\r\n\t\t\t\t\tcontent,\r\n\t\t\t\t\tposition,\r\n\t\t\t\t\tmaxWidth,\r\n\t\t\t\t\trowGap\r\n\t\t\t\t} = shape.shape\r\n\t\t\t\r\n\t\t\t\tconst {\r\n\t\t\t\t\ttextBaseline,\r\n\t\t\t\t\tfontSize,\r\n\t\t\t\t\ttextAlign\r\n\t\t\t\t} = shape.style\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tlet [x, y] = position\r\n\t\t\t\r\n\t\t\t\tcontent = content.split('\\n')\r\n\t\t\t\tconst rowNum = content.length\r\n\t\t\t\tconst lineHeight = fontSize + rowGap\r\n\t\t\t\tconst allHeight = rowNum * lineHeight - rowGap\r\n\t\t\t\tconst twidth = render.ctx.measureText(content + \"\").width;\r\n\t\t\t\tif (textBaseline === 'middle') {\r\n\t\t\t\r\n\t\t\t\t\ty -= allHeight * rowNum + fontSize / 2\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tif (textBaseline === 'bottom') {\r\n\t\t\t\r\n\t\t\t\t\ty += fontSize\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tif (textAlign === 'center') {\r\n\t\t\t\t\tx -= twidth / 2\r\n\t\t\t\t\ty += fontSize\r\n\t\t\t\t}\r\n\t\t\t\treturn [x, y, twidth, allHeight]\r\n\t\t\t\t// measureText\r\n\t\t\t},\r\n\t\t\ttouchend_app(event) {\r\n\t\t\t\tlet t = this;\r\n\t\t\t\tlet evx = 0;\r\n\t\t\t\tlet evy = 0;\r\n\t\t\t\t//触摸\r\n\t\t\t\tif (event.type.indexOf('mouse') == -1 && event.changedTouches.length == 1) {\r\n\t\t\t\t\tevx = event.changedTouches[0].x\r\n\t\t\t\t\tevy = event.changedTouches[0].y\r\n\t\t\t\t\t//电脑端。\r\n\t\t\t\t} else {\r\n\t\t\t\t\tevx = event.pageX - this.app_opts.canvaConfig.left\r\n\t\t\t\t\tevy = event.pageY - this.app_opts.canvaConfig.top;\r\n\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tlet x = evx;\r\n\t\t\t\tlet y = evy;\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tthis.dragGrpahId = \"\";\r\n\t\t\t\tthis.isDrag = false\r\n\t\t\t\t//触发画板的事件。\r\n\t\t\t\tthis.$emit('touchend', {\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y\r\n\t\t\t\t})\r\n\t\t\t\t//在那个元素上离开的。\r\n\t\t\t\tlet gps = render_app.graphs;\r\n\t\t\t\tlet isClickGrpahs = gps.filter((el, index) => {\r\n\t\t\t\t\tif (el.name == 'text') {\r\n\t\t\t\t\t\tlet rect = t.getTextWidthAndPos(el);\r\n\t\t\t\t\t\tel.hoverRect = rect\r\n\t\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\t\treturn el.hoverCheck([x, y], el) || el.hoverCheckProcessor([x, y], el);\r\n\t\t\t\t});\r\n\t\t\t\r\n\t\t\t\tif (isClickGrpahs.length > 0) {\r\n\t\t\t\t\tlet nowgap = isClickGrpahs[0];\r\n\t\t\t\r\n\t\t\t\t\t// 执行元素上绑定的事件。\r\n\t\t\t\t\tif (nowgap[event.type]) nowgap[event.type].call(nowgap, {\r\n\t\t\t\t\t\tx: x,\r\n\t\t\t\t\t\ty: y\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttouchmove_app(event) {\r\n\t\t\t\tlet t = this;\r\n\t\t\t\tlet evx = 0;\r\n\t\t\t\tlet evy = 0;\r\n\t\t\t\tlet isPc = false\r\n\t\t\t\t//触摸\r\n\t\t\t\tif (event.type.indexOf('mouse') == -1 && event.changedTouches.length == 1) {\r\n\t\t\t\t\tevx = event.changedTouches[0].x\r\n\t\t\t\t\tevy = event.changedTouches[0].y\r\n\t\t\t\t\tisPc = false\r\n\t\t\t\t\t//电脑端。\r\n\t\t\t\t} else {\r\n\t\t\t\t\t\r\n\t\t\t\t\tevx = event.pageX - this.app_opts.canvaConfig.left\r\n\t\t\t\t\tevy = event.pageY - this.app_opts.canvaConfig.top;\r\n\t\t\t\t\tisPc = true;\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tlet movex = evx - this.old_x;\r\n\t\t\t\tlet movey = evy - this.old_y;\r\n\t\t\t\tlet x = evx;\r\n\t\t\t\tlet y = evy;\r\n\t\t\t\t// 触发发画板的事件\r\n\t\t\t\tthis.$emit('touchmove', {\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y\r\n\t\t\t\t})\r\n\t\t\t\tif(this.isDrag==false) return;\r\n\t\t\t\t//在哪个元素移动的。\r\n\t\t\t\tlet gps = render_app.graphs;\r\n\t\t\t\tlet isClickGrpahs = gps.filter((el, index) => {\r\n\t\t\t\t\treturn (el.hoverCheck([x, y], el) || el.hoverCheckProcessor([x, y], el))&&el.tmid==t.dragGrpahId;\r\n\t\t\t\t});\r\n\t\t\t\r\n\t\t\t\tif (isClickGrpahs.length > 0) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet nowgap = isClickGrpahs[0];\r\n\t\t\t\t\tif (isPc) {\r\n\t\t\t\t\t\tmovex = evx - this.old_x;\r\n\t\t\t\t\t\tmovey = evy - this.old_y;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ((nowgap.drag === true && this.isDrag == true) || (nowgap.drag === true && isPc == false)) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (nowgap.name == \"circle\" || nowgap.name == \"ellipse\" ||\r\n\t\t\t\t\t\t\tnowgap.name == \"ring\" || nowgap.name == \"arc\" || nowgap.name == \"regPolygon\") {\r\n\t\t\t\t\t\t\tnowgap.attr('shape', {\r\n\t\t\t\t\t\t\t\trx: movex,\r\n\t\t\t\t\t\t\t\try: movey\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else if (nowgap.name == \"rect\" ||nowgap.name ==  'rectRound'|| nowgap.name == \"path\"|| nowgap.name == \"image\"|| nowgap.name == \"star\" || nowgap.name =='arrow') {\r\n\t\t\t\t\t\t\tnowgap.attr('shape', {\r\n\t\t\t\t\t\t\t\tx: movex,\r\n\t\t\t\t\t\t\t\ty: movey\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else if (nowgap.name == \"text\") {\r\n\t\t\t\t\t\t\tnowgap.attr('shape', {\r\n\t\t\t\t\t\t\t\tposition: [movex, movey]\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\t\t\t// 执行元素上绑定的事件。\r\n\t\t\t\t\t\tif (nowgap[event.type]) nowgap[event.type].call(nowgap, {\r\n\t\t\t\t\t\t\tx: movex,\r\n\t\t\t\t\t\t\ty: movey\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t},\r\n\t\t\ttouchstart_app(event) {\r\n\t\t\t\t\r\n\t\t\t\tlet t = this;\r\n\t\t\t\tlet evx = 0;\r\n\t\t\t\tlet evy = 0;\r\n\t\t\t\tlet isPc = false\r\n\t\t\t\t//触摸\r\n\t\t\t\tif (event.type.indexOf('mouse') == -1 && event.changedTouches.length == 1) {\r\n\t\t\t\t\tevx = event.changedTouches[0].x\r\n\t\t\t\t\tevy = event.changedTouches[0].y\r\n\t\t\t\t\tisPc = false\r\n\t\t\t\t\t//电脑端。\r\n\t\t\t\t} else {\r\n\t\t\t\t\tevx = event.pageX - this.app_opts.canvaConfig.left\r\n\t\t\t\t\tevy = event.pageY -  this.app_opts.canvaConfig.top\r\n\t\t\t\t\tisPc = true;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet x = evx\r\n\t\t\t\tlet y = evy\r\n\t\t\t\r\n\t\t\t\tlet gps = render_app.graphs;\r\n\t\t\t\t\r\n\t\t\t\t//点中了哪些图片，第一个是最顶层的，依次类推。\r\n\t\t\t\tlet isClickGrpahs = gps.filter((el, index) => {\r\n\t\t\t\t\treturn el.hoverCheck([x, y], el) || el.hoverCheckProcessor([x, y], el);\r\n\t\t\t\t});\r\n\t\t\t\r\n\t\t\t\tif (isClickGrpahs.length > 0) {\r\n\t\t\t\t\tvar indexOfMax = 0;\r\n\t\t\t\t\tvar max = isClickGrpahs.reduce( (a,c,i) => c.index > a ? (indexOfMax = i,c.index) : a, 0)\r\n\t\t\t\t\tlet nowgap = isClickGrpahs[indexOfMax];\r\n\t\t\t\t\tif (nowgap.drag === true) {\r\n\t\t\t\t\t\tthis.dragGrpahId = nowgap.tmid;\r\n\t\t\t\t\t\tlet gapPos = [];\r\n\t\t\t\t\t\tif (nowgap.name == \"circle\" || nowgap.name == \"ellipse\" ||\r\n\t\t\t\t\t\t\tnowgap.name == \"ring\" || nowgap.name == \"arc\" || nowgap.name == \"regPolygon\"\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tgapPos = [nowgap.shape.rx, nowgap.shape.ry]\r\n\t\t\t\t\t\t} else if (nowgap.name == \"rect\" ||nowgap.name ==  'rectRound'|| nowgap.name == \"path\"|| nowgap.name == \"image\"|| nowgap.name == \"star\"|| nowgap.name =='arrow') {\r\n\t\t\t\t\t\t\tgapPos = [nowgap.shape.x, nowgap.shape.y]\r\n\t\t\t\t\t\t} else if (nowgap.name == \"text\") {\r\n\t\t\t\t\t\t\tgapPos = nowgap.shape.position\r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t\tif (isPc) {\r\n\t\t\t\t\t\t\tthis.old_x = evx - gapPos[0]\r\n\t\t\t\t\t\t\tthis.old_y = evy - gapPos[1];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.old_x = x - gapPos[0];\r\n\t\t\t\t\t\t\tthis.old_y = y - gapPos[1];\r\n\t\t\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\t\t\tthis.isDrag = true\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 执行元素上绑定的事件。\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (nowgap[event.type]) nowgap[event.type].call(nowgap, {\r\n\t\t\t\t\t\tx: x,\r\n\t\t\t\t\t\ty: y\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.dragGrpahId = \"\"\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tthis.$emit('touchstart', {\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n</script>\r\n<style lang=\"scss\">\r\n\tbody {}\r\n</style>\n","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./tm-render.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./tm-render.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1646877224030\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}